<!DOCTYPE html><html class="theme-next pisces use-motion" lang="zh-Hans"><head><link rel=manifest href=/manifest.json><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-2723999557244339",enable_page_level_ads:!0})</script><script async custom-element="amp-auto-ads" src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js"></script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="-Bqv9aqSlTbZoUPK6eHxahbTSNaTL0vsBrhitCxRySU"><meta name="msvalidate.01" content="B7CA3B97FD36FB3B67FA58785C4B41D6"><meta name="baidu-site-verification" content="JZv8ka48G3"><meta name="360-site-verification" content="2127855539928c14065f093620852781"><meta name="sogou_site_verification" content="PYfZLHZRHz"><link href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.css" rel="stylesheet" type="text/css"><link href="https://fonts.loli.net/css?family=EB+Garamond:400,400i,700,700i|Noto+Serif+SC:400,500,700&display=swap&subset=chinese-simplified" rel="stylesheet"><link href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="加速,Pjax,"><link rel="alternate" href="/atom.xml" title="Leaface" type="application/atom+xml"><meta name="description" content="说起 PJAX，已是由来已久，在很多网站上经常会遇到。它通过 PushState + Ajax 技术，实现 HTML 页面局部刷新等功能，提供了一种极速的浏览体验。避免每次载入过多的重复资源，耗费额外加载时间，提升了网站的整体访问速度。最直观的体验就是音乐能全局播放了！"><meta name="keywords" content="加速,Pjax"><meta property="og:type" content="article"><meta property="og:title" content="PJAX加速站点访问"><meta property="og:url" content="https://www.liaofuzhan.com/posts/2913572160.html"><meta property="og:site_name" content="Leaface"><meta property="og:description" content="说起 PJAX，已是由来已久，在很多网站上经常会遇到。它通过 PushState + Ajax 技术，实现 HTML 页面局部刷新等功能，提供了一种极速的浏览体验。避免每次载入过多的重复资源，耗费额外加载时间，提升了网站的整体访问速度。最直观的体验就是音乐能全局播放了！"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/leafjame/cdn/img/articles/39/1.jpg"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/leafjame/cdn/img/articles/39/2.jpg"><meta property="og:updated_time" content="2023-08-19T05:26:00.453Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="PJAX加速站点访问"><meta name="twitter:description" content="说起 PJAX，已是由来已久，在很多网站上经常会遇到。它通过 PushState + Ajax 技术，实现 HTML 页面局部刷新等功能，提供了一种极速的浏览体验。避免每次载入过多的重复资源，耗费额外加载时间，提升了网站的整体访问速度。最直观的体验就是音乐能全局播放了！"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/leafjame/cdn/img/articles/39/1.jpg"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Pisces",version:"5.1.4",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!1,onmobile:!0},fancybox:!0,tabs:!0,motion:{enable:!0,async:!0,transition:{post_block:"flipYIn",post_header:"perspectiveRightIn",post_body:"perspectiveLeftIn",coll_header:"swoopIn",sidebar:"shrinkIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://www.liaofuzhan.com/posts/2913572160.html"><script></script><title>PJAX加速站点访问 | Leaface</title><script>!function(e,a,t,n,g,c){e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,g=a.createElement(t),c=a.getElementsByTagName(t)[0],g.async=1,g.src="https://www.google-analytics.com/analytics.js",c.parentNode.insertBefore(g,c)}(window,document,"script","ga"),ga("create","UA-149253035-1","auto"),ga("send","pageview")</script><script type="text/javascript">var _hmt=_hmt||[];function baiduAnalytics(){var e=document.createElement("script"),t=(e.async=!0,e.src="https://hm.baidu.com/hm.js?74f4695e267b4ebc0f65690245bfc59a",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)}baiduAnalytics()</script><script async type="text/javascript" src="https://cdn.jsdelivr.net/gh/leafjame/cdn/js/src/bubble.js?v=2.3.1"></script><meta name="viewport" content="width=device-width,initial-scale=0.9,maximum-scale=0.9"></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><amp-auto-ads type="adsense" data-ad-client="ca-pub-2723999557244339"></amp-auto-ads><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>const btw=new BTWPlugin</script><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><a href="https://github.com/leafjame/hexo-theme-next5-leaf" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#64ceaa;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="javascript:void(0);" onclick='$("html, body").animate({scrollTop:0},500)' class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Leaface</span> <span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">Stay Hungry Stay Foolish</h1></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li data-pjax class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li data-pjax class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li data-pjax class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li data-pjax class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li data-pjax class="menu-item menu-item-life"><a href="/life/" rel="section"><i class="menu-item-icon fa fa-fw fa-apple"></i><br>生活</a></li><li data-pjax class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="menu-item-icon fa fa-fw fa-link"></i><br>友链</a></li><li data-pjax class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><div id="leaface"><article class="post post-type-categories" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.liaofuzhan.com/posts/2913572160.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="北宸"><meta itemprop="description" content="人在江湖，生不由己"><meta itemprop="image" content="https://cdn.jsdelivr.net/gh/leafjame/cdn/img/logo/beichen.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Leaface"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">PJAX加速站点访问</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><time title="创建于" itemprop="dateCreated datePublished" datetime="2020-05-01T10:55:51+08:00">2020-05-01 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tech/" itemprop="url" rel="index"><span itemprop="name">Tech</span> </a></span></span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/posts/2913572160.html#comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/posts/2913572160.html" itemprop="commentCount"></span> </a></span><span id="/posts/2913572160.html" class="leancloud_visitors" data-flag-title="PJAX加速站点访问"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="leancloud-visitors-count"></span></span></div></header><div class="post-body" itemprop="articleBody"><p>说起 PJAX，已是由来已久，在很多网站上经常会遇到。它通过 PushState + Ajax 技术，实现 HTML 页面局部刷新等功能，提供了一种极速的浏览体验。避免每次载入过多的重复资源，耗费额外加载时间，提升了网站的整体访问速度。最直观的体验就是音乐能全局播放了！</p><a id="more"></a><blockquote><p>Tips：本站集成的 PJAX 功能会随着 <a href="https://github.com/leafjame/hexo-theme-next5-leaf" target="_blank" rel="noopener">v2.2</a> 版本一起发布！</p></blockquote><p>在 Github 上，PJAX 用的最多的主要是这两版：<a href="https://github.com/defunkt/jquery-pjax" target="_blank" rel="noopener">defunkt/jquery-pjax</a> 和 <a href="https://github.com/MoOx/pjax" target="_blank" rel="noopener">MoOx/pjax</a></p><h3 id="defunkt-jquery-pjax"><a href="#defunkt-jquery-pjax" class="headerlink" title="defunkt/jquery-pjax"></a>defunkt/jquery-pjax</h3><p>依赖 JQuery，最近更新停留在三年前，文档介绍有服务端配置：</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="RUBY"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><figure class="iseeu highlight /ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Server-side configuration</span></span><br><span class="line"><span class="comment"># Ideally, your server should detect pjax requests by looking at the special X-PJAX HTTP header, and render only the HTML meant to replace the contents of the container element (#pjax-container in our example) without the rest of the page layout. Here is an example of how this might be done in Ruby on Rails:</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span></span></span><br><span class="line">  <span class="keyword">if</span> request.headers[<span class="string">'X-PJAX'</span>]</span><br><span class="line">    render <span class="symbol">:layout</span> =&gt; <span class="literal">false</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></div><p>不过按操作配置完后，在我的网站效果不是很好，网上也没找到解决办法，没提到服务端配置啥的，多次尝试无果后，我也就放弃了。感兴趣的朋友可以试一下，这里贴上几篇参考文章</p><p><a href="https://learnku.com/articles/3330/pjax-site-acceleration-wing" class="LinkCard" target="_blank" rel="noopener">PJAX站点加速之翼</a></p><p><a href="https://www.fanhaobai.com/2017/07/pjax.html" class="LinkCard" target="_blank" rel="noopener">PJAX原理和使用</a></p><p><a href="https://www.ihewro.com/archives/354/comment-page-3" class="LinkCard" target="_blank" rel="noopener">typecho实现pjax</a></p><p><a href="https://lmih.cn/pjax_jiaocheng.html" class="LinkCard" target="_blank" rel="noopener">整合PJAX网页无刷新，支持评论和搜索…</a></p><h3 id="MoOx-pjax-（重点介绍）"><a href="#MoOx-pjax-（重点介绍）" class="headerlink" title="MoOx/pjax （重点介绍）"></a>MoOx/pjax （重点介绍）</h3><p>去除了 JQuery 依赖，其它功能和上一个类似。网上教程不是很多，<a href="https://sunhang.top/2019/12/20/pjax/" target="_blank" rel="noopener">这篇</a> 倒是可以参考下。高版本 <a href="https://theme-next.org/docs/third-party-services/external-libraries.html" target="_blank" rel="noopener">NEXT</a> 集成的 PJAX 也是这个。</p><div class="note danger"><p>本站 HEXO：v3.9，NEXT：v5.1.4，升级可不是件容易的事，想想还是自己折腾吧！</p></div><ol><li>首先，参照官方，在主题 _config.yml 文件中配置</li></ol><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="YML"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><figure class="iseeu highlight /yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># https://github.com/MoOx/pjax</span></span><br><span class="line"><span class="attr">pjax:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></div><ol start="2"><li>在 next/layout/_custom/ 新建 pjax.swig，内容如下</li></ol><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="HTML"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><figure class="iseeu highlight /html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"pjax_loading"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"pjax_loader"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- https://github.com/MoOx/pjax --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> pjax = <span class="keyword">new</span> Pjax(&#123;</span></span><br><span class="line"><span class="actionscript">      elements: <span class="string">'a'</span>,</span></span><br><span class="line">      selectors: [</span><br><span class="line"><span class="actionscript">        <span class="string">'title'</span>,</span></span><br><span class="line"><span class="actionscript">        <span class="string">'.content-wrap'</span>,</span></span><br><span class="line"><span class="actionscript">        <span class="string">'.sidebar-inner'</span></span></span><br><span class="line">      ],</span><br><span class="line"><span class="actionscript">      analytics: <span class="literal">false</span>,</span></span><br><span class="line"><span class="actionscript">      cacheBust: <span class="literal">false</span>,</span></span><br><span class="line"><span class="actionscript">      debug: <span class="literal">false</span>,</span></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="javascript">    $(<span class="built_in">document</span>).on(<span class="string">'pjax:send'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="actionscript">        loadingBefore(); <span class="comment">// 加载动画</span></span></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="javascript">    $(<span class="built_in">document</span>).on(<span class="string">'pjax:success'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="actionscript">        loadingAfter(); <span class="comment">// 加载动画</span></span></span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">loadingBefore</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="javascript">        $(<span class="string">"#main"</span>).fadeOut(<span class="number">100</span>);</span></span><br><span class="line"><span class="javascript">        $(<span class="string">".pjax_loading"</span>).css(<span class="string">"display"</span>, <span class="string">"block"</span>);</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">loadingAfter</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> styl = <span class="string">'&#123;&#123;theme.pjax.style&#125;&#125;'</span>;</span></span><br><span class="line"><span class="javascript">        $(<span class="string">"#main"</span>).fadeIn(<span class="number">100</span>);</span></span><br><span class="line"><span class="javascript">        $(<span class="string">".pjax_loading"</span>).css(<span class="string">"display"</span>, <span class="string">"none"</span>);</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></div><ol start="3"><li>在 next/layout/_custom/custom.swig 或者 next/layout/_layout.swig 中引入 pjax.swig</li></ol><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if theme.pjax.enable %&#125;</span><br><span class="line">   &#123;% include &apos;pjax.swig&apos; %&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure></div><p>这样配置后，网站已经初步具备 PJAX 功能了，那么接下来，就是要处理一大堆兼容的事情！</p><h3 id="灵感来源"><a href="#灵感来源" class="headerlink" title="灵感来源"></a>灵感来源</h3><p>刚开始想着按照 NEXT 高版本 PJAX 的代码来就行了，可后来发现版本间变动太大，要找起这个功能来还真不容易。后来发现也有 NEXT 5 版的主题整合了 PJAX 功能，如 <a href="https://github.com/DIYgod/hexo-theme-sagiri/commit/df8cc74ea2e134af0606e20b6470ae6e6fa53afc" target="_blank" rel="noopener">Sagiri pjax</a>、<a href="https://ilxx.gitee.io/hexo_yi_pjax.html" target="_blank" rel="noopener">Leesin’s Blog</a> 给了我一定启发。前一位将部分依赖整成 NodeJS 的 node_modules 进行引用</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">require(&apos;./utils&apos;);</span><br><span class="line">require(&apos;./motion&apos;);</span><br><span class="line">require(&apos;./affix&apos;);</span><br><span class="line">require(&apos;./pisces&apos;)();</span><br><span class="line">require(&apos;./scrollspy&apos;);</span><br><span class="line">require(&apos;./post-details&apos;)();</span><br><span class="line">require(&apos;./bootstrap&apos;);</span><br><span class="line">require(&apos;./evanyou&apos;);</span><br><span class="line">require(&apos;./leancloud&apos;)();</span><br><span class="line">require(&apos;./share&apos;)();</span><br><span class="line">require(&apos;./scroll&apos;);</span><br><span class="line">require(&apos;./since&apos;);</span><br><span class="line">require(&apos;./title&apos;);</span><br><span class="line">require(&apos;./type&apos;);</span><br><span class="line">require(&apos;./kanban&apos;);</span><br><span class="line">require(&apos;./mix&apos;);</span><br><span class="line">require(&apos;./clipboard&apos;);</span><br><span class="line">require(&apos;./pjax&apos;);</span><br><span class="line">require(&apos;./online&apos;);</span><br><span class="line">require(&apos;./search&apos;);</span><br></pre></td></tr></table></figure></div><p>不会 NodeJS 还真看不明白，后一位则将 JS 代码重新复制了一份，耦合性太高了，虽然后期改用 RequireJS。不过吧，文章整体逻辑太乱，看着真的很懵，还是自己想办法吧！</p><h3 id="柳暗花明"><a href="#柳暗花明" class="headerlink" title="柳暗花明"></a>柳暗花明</h3><p>一篇 NEXT 作者的 <a href="https://notes.iissnan.com/2015/something-about-next/" target="_blank" rel="noopener">文章</a> 引起了我的注意，看来很多主题都是类 EJS，代码相似度都挺高。多次调试代码后，终于对其渲染逻辑有了一定了解，一周多的折腾总算告一段落，再整都 HEXO 底层了。(⊙﹏⊙)b</p><p>进入网站首页，会加载很多 JS/CSS 等等，其它页面无需再次加载，直接引用即可，这就是 PJAX 要做的事情了。然而 NEXT 很多 JS 都是使用 <code>$(document).ready(function(){...})</code> 这种写法（DOM 树加载完执行），所以我们需要将这些方法提取出来，使其在别的地方能被调用到，以 next/source/js/src/schemes/pisces.js 这个 JS 为例</p><p>修改前：</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JS"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> sidebarInner = $(<span class="string">'.sidebar-inner'</span>);</span><br><span class="line"></span><br><span class="line">  initAffix();</span><br><span class="line">  resizeListener();</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">initAffix</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> headerOffset = getHeaderOffset(),</span><br><span class="line">        footerOffset = getFooterOffset(),</span><br><span class="line">        sidebarHeight = $(<span class="string">'#sidebar'</span>).height() + NexT.utils.getSidebarb2tHeight(),</span><br><span class="line">        contentHeight = $(<span class="string">'#content'</span>).height();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Not affix if sidebar taller then content (to prevent bottom jumping).</span></span><br><span class="line">    <span class="keyword">if</span> (headerOffset + sidebarHeight &lt; contentHeight) &#123;</span><br><span class="line">      sidebarInner.affix(&#123;</span><br><span class="line">        offset: &#123;</span><br><span class="line">          top: headerOffset - CONFIG.sidebar.offset,</span><br><span class="line">          bottom: footerOffset</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    setSidebarMarginTop(headerOffset).css(&#123; <span class="string">'margin-left'</span>: <span class="string">'initial'</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">resizeListener</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> mql = <span class="built_in">window</span>.matchMedia(<span class="string">'(min-width: 991px)'</span>);</span><br><span class="line">    mql.addListener(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(e.matches)&#123;</span><br><span class="line">        recalculateAffixPosition();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getHeaderOffset</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> $(<span class="string">'.header-inner'</span>).height() + CONFIG.sidebar.offset;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getFooterOffset</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> footerInner = $(<span class="string">'.footer-inner'</span>),</span><br><span class="line">        footerMargin = footerInner.outerHeight(<span class="literal">true</span>) - footerInner.outerHeight(),</span><br><span class="line">        footerOffset = footerInner.outerHeight(<span class="literal">true</span>) + footerMargin;</span><br><span class="line">    <span class="keyword">return</span> footerOffset;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">setSidebarMarginTop</span> (<span class="params">headerOffset</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> $(<span class="string">'#sidebar'</span>).css(&#123; <span class="string">'margin-top'</span>: headerOffset &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">recalculateAffixPosition</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    $(<span class="built_in">window</span>).off(<span class="string">'.affix'</span>);</span><br><span class="line">    sidebarInner.removeData(<span class="string">'bs.affix'</span>).removeClass(<span class="string">'affix affix-top affix-bottom'</span>);</span><br><span class="line">    initAffix();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div><p>修改后：</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JS"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  piscesJs();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">piscesJs</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  initAffix();</span><br><span class="line">  resizeListener();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initAffix</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> sidebarInner = $(<span class="string">'.sidebar-inner'</span>);</span><br><span class="line">  <span class="keyword">var</span> headerOffset = getHeaderOffset(),</span><br><span class="line">      footerOffset = getFooterOffset(),</span><br><span class="line">      sidebarHeight = $(<span class="string">'#sidebar'</span>).height() + NexT.utils.getSidebarb2tHeight(),</span><br><span class="line">      contentHeight = $(<span class="string">'#content'</span>).height();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Not affix if sidebar taller then content (to prevent bottom jumping).</span></span><br><span class="line">  <span class="keyword">if</span> (headerOffset + sidebarHeight &lt; contentHeight) &#123;</span><br><span class="line">    sidebarInner.affix(&#123;</span><br><span class="line">      offset: &#123;</span><br><span class="line">        top: headerOffset - CONFIG.sidebar.offset,</span><br><span class="line">        bottom: footerOffset</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  setSidebarMarginTop(headerOffset).css(&#123; <span class="string">'margin-left'</span>: <span class="string">'initial'</span> &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resizeListener</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> mql = <span class="built_in">window</span>.matchMedia(<span class="string">'(min-width: 991px)'</span>);</span><br><span class="line">  mql.addListener(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(e.matches)&#123;</span><br><span class="line">      recalculateAffixPosition();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getHeaderOffset</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> $(<span class="string">'.header-inner'</span>).height() + CONFIG.sidebar.offset;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFooterOffset</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> footerInner = $(<span class="string">'.footer-inner'</span>),</span><br><span class="line">      footerMargin = footerInner.outerHeight(<span class="literal">true</span>) - footerInner.outerHeight(),</span><br><span class="line">      footerOffset = footerInner.outerHeight(<span class="literal">true</span>) + footerMargin;</span><br><span class="line">  <span class="keyword">return</span> footerOffset;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setSidebarMarginTop</span> (<span class="params">headerOffset</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> $(<span class="string">'#sidebar'</span>).css(&#123; <span class="string">'margin-top'</span>: headerOffset &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">recalculateAffixPosition</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  $(<span class="built_in">window</span>).off(<span class="string">'.affix'</span>);</span><br><span class="line">  <span class="keyword">var</span> sidebarInner = $(<span class="string">'.sidebar-inner'</span>);</span><br><span class="line">  sidebarInner.removeData(<span class="string">'bs.affix'</span>).removeClass(<span class="string">'affix affix-top affix-bottom'</span>);</span><br><span class="line">  initAffix();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>提取出 piscesJs() 这个能外部调用的方法。其它需要修改的如 bootstrap.js、motion.js、post-details.js、scroll-cookie.js、utils.js 等，做法都类似，这里就不一一列举了。</p><div class="note info"><p>不明白？浏览器审查元素参考一下</p></div><p>在 pjax.swig 中引用抽取出来的方法，重新渲染</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JS"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="built_in">document</span>).on(<span class="string">'pjax:send'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">     loadingBefore();</span><br><span class="line">     motionJs();</span><br><span class="line">  <span class="comment">// piscesJs();</span></span><br><span class="line"> &#125;);</span><br><span class="line"></span><br><span class="line"> $(<span class="built_in">document</span>).on(<span class="string">'pjax:success'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">     bootstrapJs();</span><br><span class="line">     postDetailsJs();</span><br><span class="line">     initAffix(<span class="string">'473'</span>, <span class="string">'164'</span>); <span class="comment">// sidebar(scrollspy)</span></span><br><span class="line">     initCarousel();</span><br><span class="line">     initReadMore();</span><br><span class="line">     initIndexPostVisitor();</span><br><span class="line">     initValineAdmin();</span><br><span class="line">     linkCardFunc();</span><br><span class="line">     macPanelMan();</span><br><span class="line">     loadingAfter();</span><br><span class="line">     socialShare(<span class="string">'.social-share'</span>);</span><br><span class="line">     initRating();</span><br><span class="line">     initCodeCopy();</span><br><span class="line">     initBusuanzi();</span><br><span class="line"> <span class="comment">//  initSidebarDimension();</span></span><br><span class="line"> <span class="comment">//  baiduAnalytics();</span></span><br><span class="line"> <span class="comment">//  baiduPush();</span></span><br><span class="line"> &#125;);</span><br></pre></td></tr></table></figure></div><p>这里的 initBusuanzi()，直接是又请求了一遍</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JS"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initBusuanzi</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    $.getScript(<span class="string">"https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>后期使用 <a href="https://www.revolvermaps.com/?target=gallery" target="_blank" rel="noopener">revolvermaps</a> 替换不蒜子，参考枫糖的 <a href="https://blog.maplesugar.space/hexo/next-theme-add-revolvermaps-statistics/" target="_blank" rel="noopener">这篇文章</a></p><h3 id="一些问题"><a href="#一些问题" class="headerlink" title="一些问题"></a>一些问题</h3><h4 id="“…”-lazyload-is-not-a-function"><a href="#“…”-lazyload-is-not-a-function" class="headerlink" title="$(“…”).lazyload is not a function"></a>$(“…”).lazyload is not a function</h4><p>此错误一般是重复引入 JQuery 引起的冲突，仔细核查下引入 JQuery 的地方</p><h4 id="FancyBox-2-Ajax-跨域"><a href="#FancyBox-2-Ajax-跨域" class="headerlink" title="FancyBox 2 Ajax 跨域"></a>FancyBox 2 Ajax 跨域</h4><p>NEXT 5 集成的图片灯箱效果是 <a href="http://fancyapps.com/fancybox/" target="_blank" rel="noopener">FancyBox 2</a>，文档中也有 Ajax 渲染的方式</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JS"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">".open_ajax"</span>).fancybox(&#123;<span class="attr">type</span>: <span class="string">'ajax'</span>&#125;);</span><br></pre></td></tr></table></figure></div><p>不过在 PJAX 后总提示跨域，首次点击图片预览时有 Bug，尝试了多种方法仍是无果，官方有说</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="HTML"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><figure class="iseeu highlight /html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Note, ajax requests are subject to the same origin policy. If fancyBox will not be able to get content type, it will try to guess based on 'href' and will quit silently if would not succeed (this is different from previous versions where 'ajax' was used as default type or an error message was displayed).</span><br></pre></td></tr></table></figure></div><p>最后没办法，升级到 <a href="https://fancyapps.com/fancybox/3/" target="_blank" rel="noopener">FancyBox 3</a> 问题解决。utils.js 中的 <code>wrapImageWithFancyBox</code> 方法需要修改，用 <code>data-fancybox</code> 属性来渲染。下边的对比，可以看出 FancyBox 版本间变动还是挺大的，新版加了很多个性化功能。</p><p>FancyBox 2 预览：</p><p><img src="https://cdn.jsdelivr.net/gh/leafjame/cdn/img/articles/39/1.jpg" alt="FancyBox 2"></p><p>FancyBox 3 预览：</p><p><img src="https://cdn.jsdelivr.net/gh/leafjame/cdn/img/articles/39/2.jpg" alt="FancyBox 3"></p><h3 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h3><p>集成 PJAX 后，网站访问速度有了很大提升，请求数也少了很多，虽然还附带着这么多花里胡哨的东西，Who Care 呢。托管在 Github 上，没有个人服务器，这效果也算可以了。对于其它类 EJS 主题，这里只是抛砖引玉，大家可作个参考。</p><p>其它优化相关的文章：</p><p><a href="https://www.liaofuzhan.com/posts/1599400735.html" class="LinkCard">hexo 优化与加速</a></p><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-2723999557244339" data-ad-slot="3019522227" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class="popular-posts-header"><i class="fa fa-graduation-cap"></i> 相关文章</div><details><summary>点击查看</summary><ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-title"><a href="/posts/1599400735.html" rel="bookmark">Hexo 优化与加速</a></div></li></ul></details><div><div class="my_post_copyright"><p><span>本文标题:</span><a href="/posts/2913572160.html">PJAX加速站点访问</a></p><p><span>文章作者:</span><a href="/" title="访问 北宸 的个人网站">北宸</a></p><p><span>发布时间:</span>2020年05月01日 - 10:55:51</p><p><span>最后更新:</span>2023年08月19日 - 13:26:00</p><p><span>原始链接:</span><a href="/posts/2913572160.html" title="PJAX加速站点访问">https://www.liaofuzhan.com/posts/2913572160.html</a> <span class="copy-path" title="点击复制文章链接"><i class="fa fa-clipboard" data-clipboard-text="https://www.liaofuzhan.com/posts/2913572160.html" aria-label="复制成功！"></i></span></p><p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p></div><script>function urlCopySuccess(){document.querySelector(".fa-clipboard").click(function(){new ClipboardJS(".fa-clipboard",{target:function(t){return swal({title:"Copied!",text:"",icon:"success",timer:1500,button:!0}),t.text}})})}urlCopySuccess()</script></div><div><div><div class="read-over">-------------------本文结束 <i class="fa fa-paw"></i> 感谢您的阅读-------------------</div></div></div><div><div class="share_reward"><div>坚持原创技术分享，感谢您的支持和鼓励！</div><button id="rewardButton" disable="enable" onclick='var qr=document.getElementById("QR");"none"===qr.style.display?qr.style.display="block":qr.style.display="none"'><span>打赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"><img id="wechat_qr" src="https://cdn.jsdelivr.net/gh/leafjame/cdn/img/social/wcPay.png" alt="北宸 微信支付"><p>微信支付</p></div><div id="alipay" style="display:inline-block"><img id="alipay_qr" src="https://cdn.jsdelivr.net/gh/leafjame/cdn/img/social/aliPay.png" alt="北宸 支付宝"><p>支付宝</p></div></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/加速/" rel="tag"><i class="fa fa-tag"></i> 加速</a> <a href="/tags/Pjax/" rel="tag"><i class="fa fa-tag"></i> Pjax</a></div><div class="post-widgets"><div class="wp_rating"><div style="color:rgba(0,0,0,.75);font-size:13px;letter-spacing:4px;margin-bottom:5px">(&gt;看完记得五星好评哦亲&lt;)</div><div id="wpac-rating"></div></div></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/posts/3025236955.html" rel="prev" title="Mac 显示隐藏系统文件"><i class="fa fa-chevron-left"></i> Mac 显示隐藏系统文件</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/posts/1344151861.html" rel="next" title="Cloudflare几款实用的APP">Cloudflare几款实用的APP <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"><div data-weibo-title="分享到微博" data-qq-title="分享到QQ" data-douban-title="分享到豆瓣" class="social-share" data-disabled="qzone,google+,linkedin" data-description="Share.js - 一键分享到微博，QQ空间，腾讯微博，人人，豆瓣...">分享到：</div></div></div><script>btw.init({id:"leaface",blogId:"20598-1584112423494-167",name:"北宸 Space",qrcode:"https://cdn.jsdelivr.net/gh/leafjame/cdn/img/social/official.png",keyword:"leaface"})</script></div></div><div class="comments" id="comments"></div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-2723999557244339" data-ad-slot="3019522227" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div id="sidebar-dimmer"></div><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/"><img class="site-author-image" itemprop="image" src="https://cdn.jsdelivr.net/gh/leafjame/cdn/img/logo/beichen.png" alt="北宸"></a><p class="site-author-name" itemprop="name">北宸 <a title="官方认证" href="javascript:void(0);"><i class="sidebar_v"></i></a></p><p class="site-description motion-element" itemprop="description">人在江湖，生不由己</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">49</span> <span class="site-state-item-name">文章</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">9</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">141</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS </a><a title="收藏到书签，偶尔High一下^_^" rel="alternate" class="mw-harlem_shake_slow wobble shake" href="javascript:void(0)" onclick="(function go() {function c() {var e = document.createElement('link');e.setAttribute('type', 'text/css');e.setAttribute('rel', 'stylesheet');e.setAttribute('href', f);e.setAttribute('class', l);document.body.appendChild(e)}function h(){var e = document.getElementsByClassName(l);for(var t = 0; t< e.length; t++){document.body.removeChild(e[t])}}function p(){var e = document.createElement('div');e.setAttribute('class', a);document.body.appendChild(e);setTimeout(function(){document.body.removeChild(e)},100)}function d(e){return{height:e.offsetHeight,width:e.offsetWidth}}function v(i){var s = d(i);return s.height>e &amp;&amp;s.height<n &amp;&amp; s.width>t &amp;&amp;s.width<r}function m(e){var t=e;var n=0;while(!!t){n+=t.offsetTop;t=t.offsetParent}return n}function g(){var e=document.documentElement;if(!!window.innerWidth){return window.innerHeight}else if(e &amp;&amp; !isNaN(e.clientHeight)){return e.clientHeight}return 0}function y(){if(window.pageYOffset){return window.pageYOffset}return Math.max(document.documentElement.scrollTop,document.body.scrollTop)}function E(e){var t=m(e);return t>=w &amp;&amp; t<=b+w}var songs=['https://www.liaofuzhan.com/music/无尽光芒.mp3'];function S(){var e=document.getElementById('audio_element_id');if(e!=null){var index=parseInt(e.getAttribute('curSongIndex'));if(index>songs.length-2){index=0;}else{index++;}e.setAttribute('curSongIndex',index);N();}e.src=i;e.play()}function x(e){e.className+=' '+s+' '+o}function T(e){e.className+=' '+s+' '+u[Math.floor(Math.random()*u.length)]}function N(){var e=document.getElementsByClassName(s);var t=new RegExp('\\b'+s+'\\b');for(var n=0;n<e.length;){e[n].className=e[n].className.replace(t,'')}}function initAudioEle(){var e=document.getElementById('audio_element_id');if(e===null){e=document.createElement('audio');e.setAttribute('class',l);e.setAttribute('curSongIndex',0);e.id='audio_element_id';e.loop=false;e.bgcolor=0;e.addEventListener('canplay',function(){setTimeout(function(){x(k)},500);setTimeout(function(){N();p();for(var e=0;e<O.length;e++){T(O[e])}},15500)},true);e.addEventListener('ended',function(){N();h();go();},true);e.innerHTML='<p>If you are reading this,it is because your browser does not support the audio element. We recommend that you get a new browser.</p><p>';document.body.appendChild(e);}}initAudioEle();var e=30;var t=30;var n=350;var r=350;var curSongIndex=parseInt(document.getElementById('audio_element_id').getAttribute('curSongIndex'));var i=songs[curSongIndex];var s='mw-harlem_shake_me';var o='im_first';var u=['im_drunk','im_baked','im_trippin','im_blown'];var a='mw-strobe_light';var f='https://s3.amazonaws.com/moovweb-marketing/playground/harlem-shake-style.css';var l='mw_added_css';var b=g();var w=y();var C=document.getElementsByTagName('*');var k=null;for(var L=0;L<C.length;L++){var A=C[L];if(v(A)){if(E(A)){k=A;break}}}if(A===null){console.warn('Could not find a node of the right size. Please try a different page.');return}c();S();var O=[];for(var L=0;L<C.length;L++){var A=C[L];if(v(A)){O.push(A)}}})()"><i class="fa fa-music"></i> High~</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a rel="external nofollow" href="https://github.com/leafjame" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i></a> </span><span class="links-of-author-item"><a rel="external nofollow" href="mailto:leaf793458585@gmail.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i></a> </span><span class="links-of-author-item"><a rel="external nofollow" href="https://www.facebook.com/jame.leaf.94" target="_blank" title="Facebook"><i class="fa fa-fw fa-facebook"></i></a> </span><span class="links-of-author-item"><a rel="external nofollow" href="https://twitter.com/Leafjame" target="_blank" title="Witter"><i class="fa fa-fw fa-twitter"></i></a> </span><span class="links-of-author-item"><a rel="external nofollow" href="https://youtube.com/channel/UCtzIJK9eLCWLQF13KpZE-0w" target="_blank" title="YouTube"><i class="fa fa-fw fa-youtube"></i></a> </span><span class="links-of-author-item"><a rel="external nofollow" href="https://www.jianshu.com/u/3b74c7b81348" target="_blank" title="Jianshu"><i class="fa fa-fw fa-instagram"></i></a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-history fa-" aria-hidden="true"></i> 近期文章</div><ul class="links-of-blogroll-list"><li class="my-links-of-blogroll-li"><a href="/posts/1892723867.html" title="一行一行源码分析清楚 AbstractQueuedSynchronizer (三)" target="_blank">一行一行源码分析清楚 AbstractQueuedSynchronizer (三)</a></li><li class="my-links-of-blogroll-li"><a href="/posts/237210800.html" title="一行一行源码分析清楚 AbstractQueuedSynchronizer (二)" target="_blank">一行一行源码分析清楚 AbstractQueuedSynchronizer (二)</a></li><li class="my-links-of-blogroll-li"><a href="/posts/331601127.html" title="一行一行源码分析清楚 AbstractQueuedSynchronizer" target="_blank">一行一行源码分析清楚 AbstractQueuedSynchronizer</a></li><li class="my-links-of-blogroll-li"><a href="/posts/1059904857.html" title="SpringBoot 使用 @Transactional 无效" target="_blank">SpringBoot 使用 @Transactional 无效</a></li><li class="my-links-of-blogroll-li"><a href="/posts/712036057.html" title="使用 Certbot 申请免费的 SSL 证书" target="_blank">使用 Certbot 申请免费的 SSL 证书</a></li></ul></div><div><canvas id="canvas" style="width:60%"></canvas></div><script async>!function(){var y,X=820,F=250,w=7,P=.65,Y=[];const B=["#33B5E5","#0099CC","#AA66CC","#9933CC","#99CC00","#669900","#FFBB33","#FF8800","#FF4444","#CC0000"];var I=[],b=[[[0,0,1,1,1,0,0],[0,1,1,0,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,0,1,1,0],[0,0,1,1,1,0,0]],[[0,0,0,1,1,0,0],[0,1,1,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[1,1,1,1,1,1,1]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,1,1,0,0,0],[0,1,1,0,0,0,0],[1,1,0,0,0,0,0],[1,1,0,0,0,1,1],[1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,1,1,0],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,0,0,0,1,1,0],[0,0,0,1,1,1,0],[0,0,1,1,1,1,0],[0,1,1,0,1,1,0],[1,1,0,0,1,1,0],[1,1,1,1,1,1,1],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,1,1,1,1]],[[1,1,1,1,1,1,1],[1,1,0,0,0,0,0],[1,1,0,0,0,0,0],[1,1,1,1,1,1,0],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,0,0,0,1,1,0],[0,0,1,1,0,0,0],[0,1,1,0,0,0,0],[1,1,0,0,0,0,0],[1,1,0,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[1,1,1,1,1,1,1],[1,1,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,1,1,0,0,0,0]],[[0,0,0,0],[0,0,0,0],[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0],[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]]];function t(t){var n=[],e=(y.fillStyle="#005eac",new Date),o=70,f=e.getHours(),a=Math.floor(f/10),f=f%10,h=(n.push({num:a}),n.push({num:f}),n.push({num:10}),e.getMinutes()),a=Math.floor(h/10),f=h%10,h=(n.push({num:a}),n.push({num:f}),n.push({num:10}),e.getSeconds()),a=Math.floor(h/10),f=h%10;n.push({num:a}),n.push({num:f});for(var r=0;r<n.length;r++)o=function(t,n,e,o){for(var f=b[e],a=0;a<f.length;a++)for(var h=0;h<f[a].length;h++)1==f[a][h]&&(o.beginPath(),o.arc(t+w+2*w*h,n+w+2*w*a,w,0,2*Math.PI),o.fill());return o.beginPath(),t+=f[0].length*w*2}(n[r].offsetX=o,30,n[r].num,t),r<n.length-1&&10!=n[r].num&&10!=n[r+1].num&&(o+=10);if(0==I.length)I=n;else for(var l=0;l<I.length;l++)if(I[l].num!=n[l].num){m=i=v=g=s=u=void 0;for(var u=n[l],s=u.num,g=b[s],v=0;v<g.length;v++)for(var m,i=0;i<g[v].length;i++)1==g[v][i]&&(m={offsetX:u.offsetX+w+2*w*i,offsetY:30+w+2*w*v,color:B[Math.floor(Math.random()*B.length)],g:1.5+Math.random(),vx:4*Math.pow(-1,Math.ceil(10*Math.random()))+Math.random(),vy:-5},Y.push(m));I[l].num=n[l].num}for(var c=t,M=0;M<Y.length;M++)c.beginPath(),c.fillStyle=Y[M].color,c.arc(Y[M].offsetX,Y[M].offsetY,w,0,2*Math.PI),c.fill();for(var p=0,d=0;d<Y.length;d++){var C=Y[d];C.offsetX+=C.vx,C.offsetY+=C.vy,C.vy+=C.g,C.offsetY>F-w&&(C.offsetY=F-w,C.vy=-C.vy*P),C.offsetX>w&&C.offsetX<X-w&&(Y[p]=Y[d],p++)}for(;p<Y.length;p++)Y.pop()}var n=document.getElementById("canvas");n.width=X,n.height=F,y=n.getContext("2d"),new Date;setInterval(function(){y.clearRect(0,0,y.canvas.width,y.canvas.height),t(y)},50)}()</script></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#defunkt-jquery-pjax"><span class="nav-number">1.</span> <span class="nav-text">defunkt/jquery-pjax</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MoOx-pjax-（重点介绍）"><span class="nav-number">2.</span> <span class="nav-text">MoOx/pjax （重点介绍）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#灵感来源"><span class="nav-number">3.</span> <span class="nav-text">灵感来源</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#柳暗花明"><span class="nav-number">4.</span> <span class="nav-text">柳暗花明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#一些问题"><span class="nav-number">5.</span> <span class="nav-text">一些问题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#“…”-lazyload-is-not-a-function"><span class="nav-number">5.1.</span> <span class="nav-text">$(“…”).lazyload is not a function</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#FancyBox-2-Ajax-跨域"><span class="nav-number">5.2.</span> <span class="nav-text">FancyBox 2 Ajax 跨域</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#写在最后"><span class="nav-number">6.</span> <span class="nav-text">写在最后</span></a></li></ol></div></div></section><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-2723999557244339" data-ad-slot="3019522227" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; 2019 &mdash; <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="fa fa-heartbeat"></i> </span><span class="post-meta-divider">|</span> <span><a href="https://beian.miit.gov.cn/" class="theme-link" style="color:#b9b9b9!important" target="_blank">京 ICP 备 2020039528 号</a> </span><span class="post-meta-divider">|</span> <span class="revolvermaps"><script type="text/javascript" src="//rf.revolvermaps.com/0/0/3.js?i=5mkre995a55&amp;b=0&amp;s=20&amp;m=0&amp;cl=ffffff&amp;co=010020&amp;cd=ff0000&amp;v0=30&amp;v1=60&amp;r=1" async></script></span></div><div class="subscribe-box"><div class="subscribe-menu"><div class="subscribe-hover"><div class="subscribe-description">微信扫一扫，关注公众号</div></div></div></div></div></footer></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery@2.2.4/dist/jquery.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/fastclick/1.0.6/fastclick.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery-lazyload@1.9.7/jquery.lazyload.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/velocity-animate@1.2.1/velocity.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/npm/velocity-animate@1.2.1/velocity.ui.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script>function addCount(e){var t=$(".leancloud_visitors"),n=t.attr("id").trim(),o=t.attr("data-flag-title").trim();e("get","/classes/Counter",{where:JSON.stringify({url:n})}).done(function({results:t}){0<t.length?(t=t[0],$(document.getElementById(n)).find(".leancloud-visitors-count").text(t.time+1),e("put","/classes/Counter/"+t.objectId,JSON.stringify({time:{__op:"Increment",amount:1}})).fail(function({responseJSON:t}){console.log("Failed to save Visitor num, with error message: "+t.error)})):e("post","/classes/Counter",JSON.stringify({title:o,url:n,time:1})).done(function(){$(document.getElementById(n)).find(".leancloud-visitors-count").text(1)}).fail(function(){console.log("Failed to create")})}).fail(function({responseJSON:t}){console.log("LeanCloud Counter Error: "+t.code+" "+t.error)})}function showTime(t){var l=[],u=$(".leancloud_visitors");u.each(function(){l.push($(this).attr("id").trim())}),t("get","/classes/Counter",{where:JSON.stringify({url:{$in:l}})}).done(function({results:t}){var e=".leancloud-visitors-count";if(0===t.length)u.find(e).text(0);else{for(var n=0;n<t.length;n++){var o=t[n],i=o.url,o=o.time,r=document.getElementById(i);$(r).find(e).text(o)}for(n=0;n<l.length;n++){var i=l[n],r=document.getElementById(i),s=$(r).find(e);""==s.text()&&s.text(0)}}}).fail(function({responseJSON:t}){console.log("LeanCloud Counter Error: "+t.code+" "+t.error)})}function initIndexPostVisitor(){$.get("https://app-router.leancloud.cn/2/route?appId=bkzSiR9AEwpmJXPiKWKYuNBU-MdYXbMMI").done(function({api_server:o}){function t(t,e,n){return $.ajax({method:t,url:"https://"+o+"/1.1"+e,headers:{"X-LC-Id":"bkzSiR9AEwpmJXPiKWKYuNBU-MdYXbMMI","X-LC-Key":"69fHh20qGvuwIzcUjUxPu66F","Content-Type":"application/json"},data:n})}1==$(".leancloud_visitors").length?addCount(t):1<=$(".post-title-link").length&&showTime(t)})}$(function(){initIndexPostVisitor()})</script><script type="text/javascript">var isfetched=!1,isXml=!0,search_path="./public/search.xml",path=(0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1),"/"+search_path),onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")};function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var searchFunc=function(t,s,a){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");function e(){var e,m=n.value.trim().toLowerCase(),x=m.split(/[\s\-]+/),w=(1<x.length&&x.push(m),[]);0<m.length&&o.forEach(function(t){var e=!1,o=0,h=0,n=t.title.trim(),r=n.toLowerCase(),s=t.content.trim().replace(/<[^>]+>/g,""),a=s.toLowerCase(),i=decodeURIComponent(t.url),c=[],l=[];if(""!=n&&(x.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r,s=0,a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());-1<(r=e.indexOf(t,s));)a.push({position:r,word:t}),s=r+n;return a}c=c.concat(e(t,r,!1)),l=l.concat(e(t,a,!1))}),0<c.length||0<l.length)&&(e=!0,o=c.length+l.length),e){function p(t,e,o,n){for(var r=n[n.length-1],s=r.position,a=r.word,i=[],c=0;s+a.length<=o&&0!=n.length;){a===m&&c++,i.push({position:s,length:a.length});var l=s+a.length;for(n.pop();0!=n.length&&(s=(r=n[n.length-1]).position,a=r.word,s<l);)n.pop()}return h+=c,{hits:i,start:e,end:o,searchTextCount:c}}[c,l].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});for(var t=[],u=(0!=c.length&&t.push(p(0,0,n.length,c)),[]);0!=l.length;){var f=l[l.length-1],d=f.position,f=f.word,g=d-20,v=d+80;g<0&&(g=0),(v=v<d+f.length?d+f.length:v)>s.length&&(v=s.length),u.push(p(0,g,v,l))}u.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});e=parseInt("1");function $(o,t){var n="",r=t.start;return t.hits.forEach(function(t){n+=o.substring(r,t.position);var e=t.position+t.length;n+='<b class="search-keyword">'+o.substring(t.position,e)+"</b>",r=e}),n+=o.substring(r,t.end)}0<=e&&(u=u.slice(0,e));var C="";C+=0!=t.length?"<li><a href='"+i+"' class='search-result-title'>"+$(n,t[0])+"</a>":"<li><a href='"+i+"' class='search-result-title'>"+n+"</a>",u.forEach(function(t){C+="<a href='"+i+'\'><p class="search-result">'+$(s,t)+"...</p></a>"}),C+="</li>",w.push({item:C,searchTextCount:h,hitCount:o,id:w.length})}}),1===x.length&&""===x[0]?r.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>':0===w.length?r.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>':(w.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id}),e='<ul class="search-result-list">',w.forEach(function(t){e+=t.item}),e+="</ul>",r.innerHTML=e)}var o=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,n=document.getElementById(s),r=document.getElementById(a);n.addEventListener("input",e),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),!1===isfetched?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){27===t.which&&$(".search-popup").is(":visible")&&onPopupClose()})</script><script src="//cdn.jsdelivr.net/npm/leancloud-storage@3.0.4/dist/av-min.js"></script><script src="https://cdn.jsdelivr.net/gh/leafjame/cdn/js/valine/Valine.min.js?v=2.3.1"></script><script type="text/javascript">function initValineAdmin(){var n;new Valine({lang:"zh-cn",admin_email:"342528558@qq.com",el:"#comments",appId:"bkzSiR9AEwpmJXPiKWKYuNBU-MdYXbMMI",appKey:"69fHh20qGvuwIzcUjUxPu66F",emoticon_url:"https://cdn.jsdelivr.net/gh/leafjame/cdn/emoji",emoticon_list:["大佬.gif","点赞.gif","尴尬.gif","鼓掌.gif","笑哭.gif","害羞.gif","黑人问号.gif","坏笑.gif","惊吓.gif","可爱.gif","抠鼻子.gif","流汗.gif","色.gif","吐血.gif","无奈.gif","huaji.png","liuhanhuaji.png","mojinghuaji.png","coshuaji.png","shounuehuaji.png","jizhi.png","doge.png","chigua.png","motion_1016.png","motion_1012.png","motion_1017.png","f_hufen.png","f_geili.png","f_jiong.png","f_meng.png","f_shenma.png","f_v5.png","c_onef.png","c_onem.png","c_fivem.png","c_oney.png","c_teny.png","c_oy.png","1f60a.png","1f60b.png","1f60d.png","1f60e.png","1f61a.png","1f62d.png","1f601.png","1f602.png","1f605.png","1f606.png","1f607.png","1f618.png","1f630.png","1f631.png","1f632.png","1f633.png","1f63e.png","1f63f.png","1f638.png","1f639.png","zhayanjian.gif","ciya.gif","xieyanxiao.gif","huaixiao.gif","xiaoku.gif","leiben.gif","penxue.gif","hanxiao.gif","baiyan.gif","cahan.gif","fadai.gif","haixiu.gif","haqian.gif","ku.gif","liuhan.gif","OK.gif","qiang.gif","woshou.gif","baoquan.gif","qiudale.gif","se.gif","yinxian.gif","yun.gif","zaijian.gif"],placeholder:"&#x270d;&nbsp;写评论"}),window.location.hash&&(n=setInterval(function(){$(window.location.hash).length&&($("html, body").animate({scrollTop:$(window.location.hash).offset().top-90},1e3),clearInterval(n))},100))}initValineAdmin()</script><script>function baiduPush(){var t=document.createElement("script"),s=(t.async=!0,window.location.protocol.split(":")[0]),s=(t.src="https"===s?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",document.getElementsByTagName("script")[0]);s.parentNode.insertBefore(t,s)}baiduPush()</script><script type="text/javascript">(wpac_init=window.wpac_init||[]).push({widget:"Rating",id:20406,el:"wpac-rating",color:"ff9800"}),function(){var e,t;"WIDGETPACK_LOADED"in window||(WIDGETPACK_LOADED=!0,(e=document.createElement("script")).type="text/javascript",e.async=!0,e.src="//embed.widgetpack.com/widget.js",(t=document.getElementsByTagName("script")[0]).parentNode.insertBefore(e,t.nextSibling))}()</script><script async src="https://cdn.jsdelivr.net/gh/leafjame/cdn/js/cursor/love.min.js?v=2.3.1"></script><script async>!function(t,h,e,j){t.hj=t.hj||function(){(t.hj.q=t.hj.q||[]).push(arguments)},t._hjSettings={hjid:1453740,hjsv:6},e=h.getElementsByTagName("head")[0],(j=h.createElement("script")).async=1,j.src="https://static.hotjar.com/c/hotjar-"+t._hjSettings.hjid+".js?sv="+t._hjSettings.hjsv,e.appendChild(j)}(window,document)</script><script src="https://cdn.jsdelivr.net/gh/leafjame/cdn/js/src/activate-power-mode.min.js?v=2.3.1"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!1,document.body.addEventListener("input",POWERMODE)</script><style>.world{position:fixed;right:20px;bottom:30px;-webkit-perspective:800px;perspective:800px;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.cube{-webkit-transform-style:preserve-3d;transform-style:preserve-3d;-webkit-backface-visibility:hidden;backface-visibility:hidden;width:3vh;height:3vh;position:relative;-webkit-animation:rotator 4.5s linear infinite;animation:rotator 4.5s linear infinite;outline:0}.cube *{background:#1917178c;box-shadow:0 0 2vh currentColor;-webkit-transition:background .4s ease-in-out,box-shadow .4s ease-in-out;transition:background .4s ease-in-out,box-shadow .4s ease-in-out}.cube:hover *{background:currentColor;box-shadow:0 0 4vh currentColor}.cube .cube__front{color:#ff1493;-webkit-transform:translateZ(1.7vh);transform:translateZ(1.7vh);position:absolute;top:0;left:0;width:100%;height:100%}.cube .cube__right{color:#f08080;-webkit-transform:rotateY(90deg) translateZ(1.7vh);transform:rotateY(90deg) translateZ(1.7vh);position:absolute;top:0;left:0;width:100%;height:100%}.cube .cube__left{color:#87ceeb;-webkit-transform:rotateY(270deg) translateZ(1.7vh);transform:rotateY(270deg) translateZ(1.7vh);position:absolute;top:0;left:0;width:100%;height:100%}.cube .cube__back{color:#2e8b57;position:absolute;top:0;left:0;width:100%;height:100%;-webkit-transform:rotateY(180deg) translateZ(1.7vh);transform:rotateY(180deg) translateZ(1.7vh)}.cube .cube__top{color:#3cb371;-webkit-transform:rotateX(90deg) translateZ(1.7vh);transform:rotateX(90deg) translateZ(1.7vh);position:absolute;top:0;left:0;width:100%;height:100%}.cube .cube__bottom{color:#1e90ff;-webkit-transform:rotateX(270deg) translateZ(1.7vh);transform:rotateX(270deg) translateZ(1.7vh);position:absolute;top:0;left:0;width:100%;height:100%}@-webkit-keyframes rotator{0%{-webkit-transform:rotateX(0) rotateY(0);transform:rotateX(0) rotateY(0)}100%{-webkit-transform:rotateX(360deg) rotateY(360deg);transform:rotateX(360deg) rotateY(360deg)}}@keyframes rotator{0%{-webkit-transform:rotateX(0) rotateY(0);transform:rotateX(0) rotateY(0)}100%{-webkit-transform:rotateX(360deg) rotateY(360deg);transform:rotateX(360deg) rotateY(360deg)}}</style><div class="world"><div class="cube" tabindex="0" onclick="back2top()"><div class="cube__front"></div><div class="cube__back"></div><div class="cube__left"></div><div class="cube__right"></div><div class="cube__top"></div><div class="cube__bottom"></div></div></div><script type="text/javascript">function back2top(){$("html, body").animate({scrollTop:0},500)}</script><script async type="text/javascript" src="https://cdn.jsdelivr.net/gh/leafjame/cdn/js/figlet/fetch.min.js?v=2.3.1"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/leafjame/cdn/js/figlet/figlet.js?v=2.3.1"></script><script type="text/javascript">figlet.defaults({fontPath:"https://cdn.jsdelivr.net/gh/leafjame/cdn/js/figlet/fonts"}),figlet("Welcome To Leaface","Big Money-ne",function(e,o){e?(console.log("something went wrong..."),console.dir(e)):console.log(o)})</script><script async type="text/javascript">var text="Welcome To Leaface",date="2023-08-19";console.log("%c "+text,"font-size:100px;color:white;border-radius:20px;height:200px; background:-webkit-linear-gradient(yellow,orange,red,green,blue,purple);text-shadow: 0 1px 0 #ccc,0 2px 0 #c9c9c9,0 3px 0 #bbb,0 4px 0 #b9b9b9,0 5px 0 #aaa,0 6px 1px rgba(0,0,0,.1),0 0 5px rgba(0,0,0,.1),0 1px 3px rgba(0,0,0,.3),0 3px 5px rgba(0,0,0,.2),0 5px 10px rgba(0,0,0,.25),0 10px 10px rgba(0,0,0,.2),0 20px 20px rgba(0,0,0,.15);"),console.info("\n %c Leafae Site %c https://www.liaofuzhan.com \n","color: #fadfa3; background: #030307; padding:5px 0;","background: #fadfa3; padding:5px 0;"),console.info("\n %c Leafae QQ %c 793458585 \n","color: #fadfa3; background: #030307; padding:5px 0;","background: #fadfa3; padding:5px 0;"),console.info("\n %c Leafae Wechat %c leaface \n","color: #fadfa3; background: #030307; padding:5px 0;","background: #fadfa3; padding:5px 0;")</script><script async type="text/javascript" src="https://cdn.jsdelivr.net/gh/leafjame/cdn/js/src/clipboard.min.js?v=2.3.1"></script><script async type="text/javascript" src="https://cdn.jsdelivr.net/gh/leafjame/cdn/js/src/clipboard-use.js?v=2.3.1"></script><script src="//cdn.jsdelivr.net/npm/sweetalert@2.1.2/dist/sweetalert.min.js"></script><link async rel="stylesheet" href="https://cdn.jsdelivr.net/gh/leafjame/cdn/js/sharejs/css/share.min.css?v=2.3.1"><script async src="https://cdn.jsdelivr.net/gh/leafjame/cdn/js/sharejs/js/social-share.min.js?v=2.3.1"></script><script async type="text/javascript" src="https://cdn.jsdelivr.net/gh/leafjame/cdn/js/src/linkcard.js?v=2.3.1"></script><script src="https://cdn.jsdelivr.net/gh/leafjame/cdn/js/src/authority.js?v=2.3.1"></script><style>.GalMenu{margin:0;padding:0;display:none;position:fixed;z-index:999}.circle,.ring{height:300px;position:relative;width:300px}.circle{margin:0 auto}.ring{border-radius:50%;opacity:0;-webkit-transform-origin:50% 50%;-moz-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-transform:scale(.1) rotate(-270deg);-moz-transform:scale(.1) rotate(-270deg);-transform:scale(.1) rotate(-270deg);-webkit-transition:all .4s ease-out;-moz-transition:all .4s ease-out;transition:all .4s ease-out}.open .ring{opacity:1;-webkit-transform:scale(1) rotate(0);-moz-transform:scale(1) rotate(0);-transform:scale(1) rotate(0)}.center{background-color:rgba(255,255,255,.3);border-radius:50%;border:2px solid #fff;bottom:0;color:#fff;height:80px;left:0;line-height:80px;margin:auto;position:absolute;right:0;text-align:center;top:0;width:80px;-webkit-transition:all .4s ease-out;-moz-transition:all .4s ease-out;transition:all .4s ease-out}.open .center{border-color:#aaa}.menuItem{border-radius:50%;color:#eee;display:block;height:80px;line-height:80px;margin-left:-41px;margin-top:-41px;position:absolute;text-align:center;width:80px;background-size:80px;border:2px #b59494 solid;box-shadow:0 0 15px #fff;-webkit-box-shadow:0 0 15px #fff;-moz-box-shadow:0 0 15px #fff}.menuItem:hover{box-shadow:inset 0 0 80px #fff;-webkit-box-shadow:inset 0 0 80px #fff;-moz-box-shadow:inset 0 0 80px #fff}.ring a:nth-of-type(1){background-image:url(https://cdn.jsdelivr.net/gh/leafjame/cdn/img/icon/1.jpg)}.ring a:nth-of-type(2){background-image:url(https://cdn.jsdelivr.net/gh/leafjame/cdn/img/icon/2.jpg)}.ring a:nth-of-type(3){background-image:url(https://cdn.jsdelivr.net/gh/leafjame/cdn/img/icon/3.jpg)}.ring a:nth-of-type(4){background-image:url(https://cdn.jsdelivr.net/gh/leafjame/cdn/img/icon/4.jpg)}.ring a:nth-of-type(5){background-image:url(https://cdn.jsdelivr.net/gh/leafjame/cdn/img/icon/5.jpg)}.ring a:nth-of-type(6){background-image:url(https://cdn.jsdelivr.net/gh/leafjame/cdn/img/icon/6.jpg)}.ring a{display:inline-block;color:#fff;text-shadow:#dc965a 1px 0 0,#dc965a 0 1px 0,#dc965a -1px 0 0,#dc965a 0 -1px 0;-webkit-text-shadow:#dc965a 1px 0 0,#dc965a 0 1px 0,#dc965a -1px 0 0,#dc965a 0 -1px 0;-moz-text-shadow:#dc965a 1px 0 0,#dc965a 0 1px 0,#dc965a -1px 0 0,#dc965a 0 -1px 0}.ring a:hover{text-shadow:#6cf 1px 0 0,#6cf 0 1px 0,#6cf -1px 0 0,#6cf 0 -1px 0;-webkit-text-shadow:#6cf 1px 0 0,#6cf 0 1px 0,#6cf -1px 0 0,#6cf 0 -1px 0;-moz-text-shadow:#6cf 1px 0 0,#6cf 0 1px 0,#6cf -1px 0 0,#6cf 0 -1px 0}</style><div class="GalMenu GalDropDown"><div class="circle" id="gal"><div class="ring"><a href="/" class="menuItem">首页</a> <a href="javascript:window.history.forward();" class="menuItem">前进</a> <a href="javascript:$('html, body').animate({scrollTop: 0}, 500);" class="menuItem">回顶</a> <a href="javascript:window.location.reload();" class="menuItem">刷新</a> <a href="javascript:addFavorite('Leaface', location.href);" class="menuItem">收藏</a> <a href="javascript:window.history.back();" class="menuItem">后退</a></div><audio id="audioSong" preload="auto"></audio></div></div><div id="overlay" style="opacity:1;cursor:pointer"></div><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/leafjame/cdn/js/src/GalMenu.js?v=2.3.1"></script><script type="text/javascript">$(document).ready(function(){$("body").GalMenu({menu:"GalDropDown"})});for(var items=document.querySelectorAll(".menuItem"),i=0,l=items.length;i<l;i++)items[i].style.left=(50-35*Math.cos(-.5*Math.PI-1/l*2*i*Math.PI)).toFixed(4)+"%",items[i].style.top=(50+35*Math.sin(-.5*Math.PI-1/l*2*i*Math.PI)).toFixed(4)+"%";function addFavorite(e,a){try{window.external.addFavorite(a,e)}catch(t){try{window.sidebar.addPanel(e,a,"")}catch(t){alert("抱歉，您所使用的浏览器无法完成此操作！\n\n加入收藏失败，请使用【 Ctrl + D 】 进行添加！")}}}</script><style type="text/css">#theme-switcher{cursor:pointer;position:fixed;z-index:1;left:11px;bottom:8px}</style><div id="theme-switcher">🌞</div><script type="text/javascript">var themeSwitcher=document.getElementById("theme-switcher");function changeDarkMode(){$("body").css("background-color","#303344"),$(".sidebar-inner").css("background-color","#303344")}function changeLightMode(){$("body").css("background-color","#f5f7f9"),$(".sidebar-inner").css("background-color","#f5f7f9")}themeSwitcher.addEventListener("click",function(){var e=themeSwitcher.innerHTML;(("🌙"==e?!0:!1)?(e="🌞",changeLightMode):(e="🌙",changeDarkMode))(),themeSwitcher.innerHTML=e})</script><script id="lfz" src="https://player.liaofuzhan.com/player/player.js" key="1234567890102030"></script><script id="ribbon" type="text/javascript" size="60" alpha="0.1" zindex="-99" src="https://cdn.jsdelivr.net/gh/leafjame/cdn/js/src/ribbon.js?v=2.3.1"></script><div class="colorful_loading_frame" style="display:none"><div class="loader_overlay"></div><div class="loader_cogs"><div class="loader_cogs__top"><div class="top_part"></div><div class="top_part"></div><div class="top_part"></div><div class="top_hole"></div></div><div class="loader_cogs__left"><div class="left_part"></div><div class="left_part"></div><div class="left_part"></div><div class="left_hole"></div></div><div class="loader_cogs__bottom"><div class="bottom_part"></div><div class="bottom_part"></div><div class="bottom_part"></div><div class="bottom_hole"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript">var pjax=new Pjax({elements:"a",selectors:["title","li[data-pjax]",".content-wrap",".sidebar-inner"],analytics:!1,cacheBust:!1,debug:!1});function loadingBefore(){$("#main").fadeOut(100),$(".colorful_loading_frame").css("display","block")}function loadingAfter(){$("#main").fadeIn(100),$(".colorful_loading_frame").css("display","none")}function initRating(){0<=window.location.href.indexOf("posts")&&$.getScript("https://embed.widgetpack.com/widget.js",function(){WPac.init({widget:"Rating",id:"20406",el:"wpac-rating",color:"ff9800"})})}function initCodeCopy(){0<=window.location.href.indexOf("posts")&&($.getScript("https://cdn.jsdelivr.net/gh/leafjame/cdn/js/src/clipboard-use.js"),urlCopySuccess())}function initCarousel(){1<=$(".carousel").length&&$.getScript("https://cdn.jsdelivr.net/npm/bootstrap.min.js@3.3.5/bootstrap.min.js",function(){$(".carousel").carousel()})}function initReadMore(){1<=$("#read-more-wrap").length&&($("#leaface").attr("style","height:2000px"),btw.init({id:"leaface",blogId:"20598-1584112423494-167",name:"北宸 Space",qrcode:"https://cdn.jsdelivr.net/gh/leafjame/cdn/img/social/official.png",keyword:"leaface"}))}function initRevolvermaps(){location.href.indexOf("localhost")<0&&location.href.indexOf("127.0.0.1")<0&&$.getScript("https://rf.revolvermaps.com/js/c.php?i=5mkre995a55&r="+(new Date).getTime())}function initBusuanzi(){$.getScript("https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js")}$(document).on("pjax:send",function(){loadingBefore(),motionJs()}),$(document).on("pjax:success",function(){bootstrapJs(),postDetailsJs(),initAffix("523","164"),initCarousel(),initReadMore(),initIndexPostVisitor(),initValineAdmin(),linkCardFunc(),macPanelMan(),loadingAfter(),socialShare(".social-share"),initRating(),initCodeCopy(),initRevolvermaps(),initBusuanzi()})</script><script>if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/sw.js?t=1692424324992')
    .then(function () {console.log('ServiceWorker Register Successfully.')})
    .catch(function (e) {console.error(e)});
}
</script></body></html>